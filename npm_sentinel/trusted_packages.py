"""Curated list of top popular npm packages used as ground-truth for typosquat detection.

This module provides a comprehensive list of 500+ widely-used npm packages that serve
as the reference database for the typosquat detection engine. Any scanned package
whose name closely resembles one of these trusted packages (but is not identical to
one) is flagged as a potential typosquat.

The list is organized by category for maintainability and covers:
- Core utilities (lodash, underscore, async, etc.)
- Web frameworks (express, fastify, koa, etc.)
- Build tools (webpack, vite, rollup, etc.)
- Testing frameworks (jest, mocha, chai, etc.)
- TypeScript / transpilation tools
- React ecosystem
- Vue ecosystem
- Node.js infrastructure packages
- Database clients
- HTTP/networking libraries
- Security / crypto packages
- CLI tools
- And many more

Public API:
    TRUSTED_PACKAGES: frozenset[str] - The complete set of trusted package names
    get_trusted_packages: Function returning the trusted package set
"""

from __future__ import annotations

# ---------------------------------------------------------------------------
# Curated list of 500+ top npm packages
# ---------------------------------------------------------------------------

_TRUSTED_PACKAGES_LIST: list[str] = [
    # Core utilities
    "lodash",
    "lodash-es",
    "underscore",
    "async",
    "bluebird",
    "ramda",
    "date-fns",
    "moment",
    "luxon",
    "dayjs",
    "uuid",
    "nanoid",
    "cuid",
    "shortid",
    "hashids",
    "semver",
    "chalk",
    "colors",
    "kleur",
    "ansi-colors",
    "picocolors",
    "debug",
    "loglevel",
    "winston",
    "pino",
    "bunyan",
    "morgan",
    "dotenv",
    "cross-env",
    "envalid",
    "config",
    "nconf",
    "convict",
    "yargs",
    "commander",
    "minimist",
    "meow",
    "inquirer",
    "prompts",
    "ora",
    "listr",
    "cli-table3",
    "boxen",
    "figlet",
    "gradient-string",
    "update-notifier",
    "pkg-up",
    "find-up",
    "locate-path",
    "p-limit",
    "p-queue",
    "p-map",
    "p-retry",
    "p-timeout",
    "p-memoize",
    "bottleneck",
    "throat",
    "rxjs",
    "xstream",
    "most",
    "kefir",
    "immer",
    "immutable",
    "seamless-immutable",
    "mori",
    "deep-equal",
    "fast-deep-equal",
    "dequal",
    "clone",
    "clone-deep",
    "merge-deep",
    "deepmerge",
    "assign-deep",
    "object-assign",
    "defaults",
    "extend",
    "mixin-deep",
    "camelcase",
    "camelcase-keys",
    "snakecase-keys",
    "decamelize",
    "humanize-string",
    "titleize",
    "slug",
    "slugify",
    "speakingurl",
    "pluralize",
    "inflection",
    "leven",
    "string-similarity",
    "fastest-levenshtein",
    "validator",
    "joi",
    "yup",
    "zod",
    "ajv",
    "jsonschema",
    "is",
    "kind-of",
    "type-detect",
    "is-plain-object",
    "is-stream",
    "is-promise",
    "is-callable",
    "is-regex",
    "is-number",
    "is-string",
    "is-buffer",
    "is-object",
    "is-function",
    "is-array",
    "is-url",
    "is-ip",
    "is-email",
    "is-ci",
    "is-docker",
    "is-wsl",

    # Web frameworks and HTTP
    "express",
    "fastify",
    "koa",
    "hapi",
    "restify",
    "polka",
    "micro",
    "feathers",
    "sails",
    "loopback",
    "nest",
    "@nestjs/core",
    "@nestjs/common",
    "@nestjs/platform-express",
    "helmet",
    "cors",
    "body-parser",
    "multer",
    "busboy",
    "formidable",
    "cookie-parser",
    "cookie-session",
    "express-session",
    "passport",
    "passport-local",
    "passport-jwt",
    "jsonwebtoken",
    "bcrypt",
    "bcryptjs",
    "argon2",
    "scrypt-js",
    "axios",
    "node-fetch",
    "got",
    "superagent",
    "request",
    "needle",
    "bent",
    "undici",
    "ky",
    "http-proxy",
    "http-proxy-middleware",
    "proxy-agent",
    "https-proxy-agent",
    "tunnel",
    "socket.io",
    "socket.io-client",
    "ws",
    "uws",
    "engine.io",
    "sockjs",
    "primus",
    "faye",
    "mqtt",
    "aedes",
    "amqplib",
    "kafkajs",
    "nats",
    "ioredis",
    "redis",
    "mongoose",
    "mongodb",
    "pg",
    "pg-pool",
    "mysql",
    "mysql2",
    "sequelize",
    "typeorm",
    "knex",
    "objection",
    "bookshelf",
    "waterline",
    "prisma",
    "@prisma/client",
    "mikro-orm",
    "@mikro-orm/core",
    "sqlite3",
    "better-sqlite3",
    "level",
    "levelup",
    "lmdb",
    "nedb",
    "lokijs",
    "rxdb",

    # Build tools and bundlers
    "webpack",
    "webpack-cli",
    "webpack-dev-server",
    "webpack-merge",
    "webpack-bundle-analyzer",
    "vite",
    "@vitejs/plugin-react",
    "@vitejs/plugin-vue",
    "rollup",
    "rollup-plugin-terser",
    "parcel",
    "esbuild",
    "swc",
    "@swc/core",
    "@swc/cli",
    "turbopack",
    "snowpack",
    "browserify",
    "gulp",
    "grunt",
    "brunch",
    "fuse-box",
    "microbundle",
    "tsup",
    "unbuild",
    "pkgroll",
    "babel",
    "@babel/core",
    "@babel/cli",
    "@babel/preset-env",
    "@babel/preset-react",
    "@babel/preset-typescript",
    "@babel/plugin-transform-runtime",
    "babel-loader",
    "css-loader",
    "style-loader",
    "sass-loader",
    "less-loader",
    "file-loader",
    "url-loader",
    "html-webpack-plugin",
    "mini-css-extract-plugin",
    "copy-webpack-plugin",
    "terser-webpack-plugin",
    "compression-webpack-plugin",
    "postcss",
    "postcss-cli",
    "autoprefixer",
    "tailwindcss",
    "sass",
    "node-sass",
    "less",
    "stylus",

    # TypeScript
    "typescript",
    "ts-node",
    "ts-jest",
    "tslib",
    "tsc-alias",
    "ttypescript",
    "ts-morph",
    "ts-patch",
    "tsx",
    "@types/node",
    "@types/react",
    "@types/react-dom",
    "@types/express",
    "@types/lodash",
    "@types/jest",
    "@types/mocha",
    "@types/chai",
    "@types/supertest",
    "@types/cors",
    "@types/body-parser",
    "@types/cookie-parser",
    "@types/bcrypt",
    "@types/jsonwebtoken",
    "@types/uuid",
    "@types/semver",
    "@types/yargs",
    "@types/commander",
    "@types/inquirer",
    "@types/ws",
    "@types/multer",
    "@types/passport",

    # Testing
    "jest",
    "jest-cli",
    "jest-circus",
    "@jest/globals",
    "babel-jest",
    "mocha",
    "chai",
    "sinon",
    "jasmine",
    "karma",
    "karma-jasmine",
    "karma-chrome-launcher",
    "jasmine-core",
    "ava",
    "tape",
    "tap",
    "vitest",
    "@vitest/coverage-v8",
    "supertest",
    "nock",
    "msw",
    "faker",
    "@faker-js/faker",
    "chance",
    "casual",
    "factory-girl",
    "fishery",
    "nyc",
    "c8",
    "istanbul",
    "coverage",
    "benchmark",
    "tinybench",
    "puppeteer",
    "playwright",
    "@playwright/test",
    "cypress",
    "selenium-webdriver",
    "webdriverio",
    "nightwatch",
    "testcafe",
    "codecept",
    "detox",

    # React ecosystem
    "react",
    "react-dom",
    "react-scripts",
    "create-react-app",
    "react-router",
    "react-router-dom",
    "react-redux",
    "redux",
    "redux-thunk",
    "redux-saga",
    "redux-toolkit",
    "@reduxjs/toolkit",
    "recoil",
    "jotai",
    "zustand",
    "mobx",
    "mobx-react",
    "mobx-react-lite",
    "react-query",
    "@tanstack/react-query",
    "swr",
    "apollo-client",
    "@apollo/client",
    "react-hook-form",
    "formik",
    "react-final-form",
    "styled-components",
    "emotion",
    "@emotion/react",
    "@emotion/styled",
    "@mui/material",
    "@mui/icons-material",
    "antd",
    "@ant-design/icons",
    "@chakra-ui/react",
    "mantine",
    "@mantine/core",
    "semantic-ui-react",
    "react-bootstrap",
    "bootstrap",
    "bulma",
    "react-icons",
    "react-spring",
    "framer-motion",
    "react-transition-group",
    "react-dnd",
    "react-beautiful-dnd",
    "@dnd-kit/core",
    "react-virtualized",
    "react-window",
    "react-virtuoso",
    "react-table",
    "@tanstack/react-table",
    "react-select",
    "react-datepicker",
    "react-modal",
    "react-toastify",
    "react-hot-toast",
    "react-helmet",
    "next",
    "@next/font",
    "@next/image",
    "gatsby",
    "gatsby-plugin-react-helmet",
    "remix",
    "@remix-run/react",
    "@remix-run/node",

    # Vue ecosystem
    "vue",
    "vue-router",
    "vuex",
    "pinia",
    "@vue/composition-api",
    "@vue/cli",
    "@vue/cli-service",
    "nuxt",
    "@nuxt/content",
    "@nuxtjs/axios",
    "vue-i18n",
    "vuelidate",
    "vee-validate",
    "quasar",
    "vuetify",
    "element-plus",
    "naive-ui",
    "ant-design-vue",

    # Node.js infrastructure
    "express-validator",
    "celebrate",
    "compression",
    "serve-static",
    "serve",
    "http-server",
    "live-server",
    "nodemon",
    "pm2",
    "forever",
    "node-cron",
    "node-schedule",
    "agenda",
    "bull",
    "bullmq",
    "bee-queue",
    "kue",
    "agenda",
    "graceful-fs",
    "fs-extra",
    "glob",
    "globby",
    "fast-glob",
    "micromatch",
    "minimatch",
    "multimatch",
    "rimraf",
    "del",
    "mkdirp",
    "make-dir",
    "temp",
    "tmp",
    "tempy",
    "chokidar",
    "watchman",
    "gaze",
    "archiver",
    "unzipper",
    "node-tar",
    "tar",
    "tar-stream",
    "adm-zip",
    "jszip",
    "yauzl",
    "yazl",
    "stream-buffers",
    "readable-stream",
    "through2",
    "pump",
    "pumpify",
    "concat-stream",
    "bl",
    "get-stream",
    "into-stream",
    "duplexify",
    "split2",
    "ndjson",
    "JSONStream",
    "event-stream",
    "highland",
    "vinyl",
    "vinyl-fs",
    "vinyl-source-stream",
    "map-stream",
    "multistream",
    "byline",
    "csv",
    "csv-parser",
    "csv-writer",
    "fast-csv",
    "papaparse",
    "xlsx",
    "exceljs",
    "pdf-parse",
    "pdfkit",
    "sharp",
    "jimp",
    "canvas",
    "skia-canvas",
    "image-size",
    "probe-image-size",
    "qrcode",
    "jsbarcode",
    "node-qrcode",
    "speakeasy",
    "otplib",
    "twilio",
    "nodemailer",
    "sendgrid",
    "@sendgrid/mail",
    "mailgun-js",
    "postmark",
    "stripe",
    "paypal-rest-sdk",
    "braintree",
    "aws-sdk",
    "@aws-sdk/client-s3",
    "@aws-sdk/client-dynamodb",
    "@aws-sdk/client-lambda",
    "@google-cloud/storage",
    "@google-cloud/firestore",
    "@google-cloud/bigquery",
    "firebase",
    "firebase-admin",
    "azure-storage",
    "@azure/storage-blob",

    # GraphQL
    "graphql",
    "graphql-tag",
    "graphql-tools",
    "apollo-server",
    "@apollo/server",
    "apollo-server-express",
    "type-graphql",
    "nexus",
    "pothos",
    "mercurius",
    "express-graphql",
    "graphql-yoga",
    "graphql-ws",
    "graphql-subscriptions",
    "dataloader",
    "graphql-depth-limit",
    "graphql-rate-limit",

    # Linting and formatting
    "eslint",
    "eslint-config-airbnb",
    "eslint-config-prettier",
    "eslint-plugin-import",
    "eslint-plugin-react",
    "eslint-plugin-react-hooks",
    "eslint-plugin-jsx-a11y",
    "eslint-plugin-node",
    "eslint-plugin-security",
    "eslint-plugin-unicorn",
    "prettier",
    "husky",
    "lint-staged",
    "commitlint",
    "@commitlint/cli",
    "@commitlint/config-conventional",
    "standard",
    "xo",
    "stylelint",
    "stylelint-config-standard",
    "tslint",

    # Documentation
    "jsdoc",
    "typedoc",
    "documentation",
    "esdoc",
    "docsify-cli",
    "gitbook-cli",
    "vuepress",
    "docusaurus",
    "@docusaurus/core",
    "storybook",
    "@storybook/react",
    "@storybook/vue3",
    "@storybook/addon-essentials",
    "chromatic",

    # Tooling / DX
    "concurrently",
    "npm-run-all",
    "wait-on",
    "cross-port-killer",
    "kill-port",
    "envinfo",
    "open",
    "opener",
    "open-cli",
    "trash-cli",
    "clipboard-cli",
    "ncp",
    "cpy-cli",
    "cpx",
    "shx",
    "shelljs",
    "execa",
    "spawn-command",
    "cross-spawn",
    "npm-check-updates",
    "depcheck",
    "madge",
    "bundlesize",
    "size-limit",
    "source-map-explorer",
    "webpack-bundle-analyzer",
    "lerna",
    "nx",
    "turborepo",
    "changesets",
    "@changesets/cli",
    "release-it",
    "semantic-release",
    "standard-version",
    "conventional-changelog-cli",
    "patch-package",
    "resolve-links",
    "yalc",
    "verdaccio",

    # Miscellaneous popular packages
    "cheerio",
    "jsdom",
    "puppeteer-core",
    "playwright-core",
    "node-html-parser",
    "parse5",
    "htmlparser2",
    "sanitize-html",
    "dompurify",
    "marked",
    "showdown",
    "markdown-it",
    "remark",
    "remark-parse",
    "remark-stringify",
    "rehype",
    "unified",
    "prismjs",
    "highlight.js",
    "shiki",
    "lowlight",
    "refractor",
    "diff",
    "diff-match-patch",
    "jsdiff",
    "patch",
    "json-diff",
    "json-patch",
    "fast-json-patch",
    "jsonpatch",
    "json5",
    "hjson",
    "toml",
    "@iarna/toml",
    "js-yaml",
    "yaml",
    "dotenv-expand",
    "dotenv-flow",
    "dotenv-safe",
    "conf",
    "cosmiconfig",
    "lilconfig",
    "rc",
    "configstore",
    "preferences",
    "keytar",
    "keyv",
    "node-persist",
    "lowdb",
    "store2",
    "unstorage",
    "cacache",
    "flat-cache",
    "cache-manager",
    "memory-cache",
    "lru-cache",
    "ttl-cache",
    "memoizee",
    "memoize-one",
    "quick-lru",
    "node-cache",
    "memory-cache",
    "msgpack",
    "msgpack5",
    "cbor",
    "protobufjs",
    "flatbuffers",
    "thrift",
    "avsc",
    "ipfs",
    "ipfs-core",
    "web3",
    "ethers",
    "@ethersproject/providers",
    "viem",
    "wagmi",
    "hardhat",
    "truffle",
    "openzeppelin-contracts",
    "zksync-web3",
    "electron",
    "electron-builder",
    "electron-packager",
    "@electron-forge/cli",
    "tauri",
    "nw",
    "carlo",
    "express-rate-limit",
    "rate-limiter-flexible",
    "express-slow-down",
    "csurf",
    "hpp",
    "xss",
    "xss-filters",
    "sanitizer",
    "escape-html",
    "entities",
    "he",
    "htmlentities",
    "crypto-js",
    "node-forge",
    "openpgp",
    "tweetnacl",
    "libsodium-wrappers",
    "simple-git",
    "nodegit",
    "isomorphic-git",
    "octokit",
    "@octokit/rest",
    "@octokit/core",
    "conventional-commits-parser",
    "commitizen",
    "cz-conventional-changelog",
    "open-graph-scraper",
    "metascraper",
    "rss-parser",
    "node-html-markdown",
    "turndown",
    "pdf2json",
    "tesseract.js",
    "natural",
    "compromise",
    "franc",
    "mlly",
    "jiti",
    "esm",
    "module-alias",
    "tsconfig-paths",
    "resolve",
    "enhanced-resolve",
    "acorn",
    "esprima",
    "espree",
    "@babel/parser",
    "recast",
    "jscodeshift",
    "ast-types",
    "meriyah",
    "sucrase",
    "oxc-parser",
    "terser",
    "uglify-js",
    "clean-css",
    "cssnano",
    "purgecss",
    "uncss",
    "critical",
    "workbox-webpack-plugin",
    "workbox-core",
    "workbox-precaching",
    "workbox-routing",
    "workbox-strategies",
    "pwa-asset-generator",
    "next-pwa",
    "vite-plugin-pwa",
    "@angular/core",
    "@angular/common",
    "@angular/router",
    "@angular/forms",
    "@angular/cli",
    "@angular/compiler",
    "@angular-devkit/build-angular",
    "ngrx",
    "@ngrx/store",
    "@ngrx/effects",
    "@ngrx/entity",
    "rxjs-compat",
    "zone.js",
    "svelte",
    "@sveltejs/kit",
    "@sveltejs/vite-plugin-svelte",
    "svelte-check",
    "svelte-preprocess",
    "solid-js",
    "solid-app-router",
    "@solidjs/router",
    "@solidjs/meta",
    "preact",
    "preact-router",
    "preact-compat",
    "lit",
    "lit-element",
    "lit-html",
    "@lit/reactive-element",
    "haunted",
    "atomico",
    "stencil",
    "@stencil/core",
    "alpine",
    "alpinejs",
    "htmx.org",
    "stimulus",
    "@hotwired/stimulus",
    "@hotwired/turbo",
    "mithril",
    "hyperapp",
    "inferno",
    "inferno-dom",
    "dojo",
    "ember-cli",
    "ember-source",
    "backbone",
    "marionette",
    "knockout",
    "knockout-mapping",
    "angular",
    "angularjs",
    "jquery",
    "jquery-ui",
    "zepto",
    "cash-dom",
    "umbrella",
    "d3",
    "d3-selection",
    "d3-scale",
    "d3-axis",
    "d3-shape",
    "d3-array",
    "d3-transition",
    "chart.js",
    "recharts",
    "victory",
    "nivo",
    "@nivo/core",
    "apexcharts",
    "highcharts",
    "echarts",
    "vega",
    "vega-lite",
    "plotly.js",
    "three",
    "three.js",
    "babylon.js",
    "pixi.js",
    "phaser",
    "matter-js",
    "cannon-es",
    "rapier",
    "tone",
    "howler",
    "wavesurfer.js",
    "videojs",
    "video.js",
    "mediasoup",
    "simple-peer",
    "peerjs",
    "webrtc-adapter",
    "ml5",
    "brain.js",
    "synaptic",
    "onnxruntime-node",
    "@tensorflow/tfjs",
    "@tensorflow/tfjs-node",
    "mathjs",
    "numeric",
    "numjs",
    "ndarray",
    "simple-statistics",
    "jstat",
    "stdlib",
    "@stdlib/stdlib",
    "fraction.js",
    "decimal.js",
    "big.js",
    "bignumber.js",
    "currency.js",
    "accounting",
    "money",
    "dinero.js",
    "fx.js",
    "exchange-rates-api",
    "i18next",
    "react-i18next",
    "vue-i18n",
    "@angular/localize",
    "formatjs",
    "react-intl",
    "polyglot.js",
    "rosetta",
    "typesafe-i18n",
    "lingui",
    "@lingui/core",
    "@lingui/react",
    "intl-messageformat",
    "@formatjs/intl",
    "globalize",
    "ttag",
    "gettext.js",
    "node-gettext",
    "sprintf-js",
    "string-format",
    "printf",
    "format-message",
    "chalk-template",
    "ansi-escapes",
    "strip-ansi",
    "cli-cursor",
    "cli-spinners",
    "log-symbols",
    "figures",
    "plop",
    "hygen",
    "yeoman-generator",
    "yeoman-environment",
    "yo",
    "create-next-app",
    "create-vite",
    "create-vue",
    "@ionic/cli",
    "ionic",
    "cordova",
    "capacitor",
    "@capacitor/core",
    "@capacitor/cli",
    "react-native",
    "@react-native-community/cli",
    "expo",
    "@expo/cli",
    "nativescript",
    "appcenter-cli",
    "microsoft-cognitiveservices-speech-sdk",
]

# Deduplicate and freeze
TRUSTED_PACKAGES: frozenset[str] = frozenset(_TRUSTED_PACKAGES_LIST)


def get_trusted_packages() -> frozenset[str]:
    """Return the complete set of trusted npm package names.

    This set is used as the ground-truth reference database for typosquat
    detection. Each entry represents a known-legitimate, widely-used npm
    package. The set is deduplicated and immutable.

    Returns:
        A frozenset of lowercase npm package name strings.

    Example::

        >>> trusted = get_trusted_packages()
        >>> 'express' in trusted
        True
        >>> 'expresss' in trusted
        False
    """
    return TRUSTED_PACKAGES
